# EEG-Pipeline-for-Thesis
## Below is the methods section taken from my thesis, detailing methodological approaches and the reasoning behind them 

### EEG Data Analysis

For ERP analysis, we focused on the P300-like component measured during the encoding phase, specifically its P3b subcomponent. In line with its expected distribution, amplitudes were extracted from frontal (Fz, F3, F7, F4, F8), central (Cz, C3, C4), and parietal (Pz, P4, P3) electrodes within the 350–700 ms post-stimulus window. This extended time window takes into account developmental differences in cognitive processing speed and the broader, less focal morphology of the P3b component typically observed in children compared to adults ( van Dinteren et al., 2014; Rojas-Benjumea et al., 2015) Previous studies also indicate that parietal regions are particularly responsive to P300 components evoked by auditory and visual input, and the topography of P300 components in children is usually broader and less focused than in adults, often shifting toward more central locations (van Dinteren et al., 2014; Riggins & Scott, 2020).
The EEG datasets collected from 4-year-old children were preprocessed using a combination of automated algorithms and manual procedures to ensure high-quality signals suitable for further analyses. EEG data were analysed using EEGLAB (version 2020.0), a MATLAB- based toolbox (MathWorks, 2025, R2020b) for electrophysiological data processing. Preprocessing was conducted using the Maryland Analysis of Developmental EEG (MADE) pipeline (Debnath et al., 2020), an automated framework specifically developed for pediatric EEG datasets. Compared to adult EEG, children ́s recordings tend to be shorter in duration and more susceptible to artifacts, requiring adapted preprocessing strategies.

The full preprocessing workflow included multiple stages aimed at preparing the data for both time-domain and time-frequency analyses. The pipeline was applied to EEG recordings from the encoding phase. Key steps included data import, channel location assignment, event marker relabelling, down-sampling, bandpass and notch filtering, rereferencing, Independent Component Analysis (ICA), bad channel interpolation, and epoching. EEG data were imported in BrainVision format, and electrode positions were assigned using standardized layout files.
The signals were down-sampled from 5000 to 256 Hz and filtered using a bandpass filter (0.3–30 Hz) along with a 50 Hz notch filter to remove line noise. EEG data were re- referenced offline in software to an average reference configuration. A combination of manual and automatic procedures was used to detect bad channels. On average, 3–4 channels were manually excluded per participant based on visual inspection. Although no universal standard exists, practical preprocessing guidelines (e.g., Makoto’s EEGLAB recommendations; Miyakoshi, 2018) suggest that rejecting up to ~10% of channels in a 32- channel EEG setup is acceptable when followed by interpolation. This approach is supported by the RESIT method (Dong et al., 2021), which has demonstrated that interpolation maintains high signal fidelity under these conditions.

The original full-channel dataset was preserved for reference. To prepare the data for ICA and improve decomposition quality, a 1 Hz high-pass filter was applied. The continuous data were segmented into 1-second epochs, and segments containing extreme amplitudes (±1000 μV) or EMG-like artifacts (20–40 Hz) were excluded. ICA was then performed using
the runica algorithm. Artifact-related components (e.g., blinks, muscle activity) were identified using the ADJUST plugin, with ICLabel used as a secondary classifier when necessary. Identified components were removed prior to interpolation of the previously rejected channels.
Subsequently, final cleaning was conducted at the epoch level using rejection thresholds based on amplitude (±150 μV), joint probability, kurtosis, and spectral power (1–50 Hz). EEG data from the encoding phase were segmented into epochs ranging from –200 ms to 1000 ms relative to stimulus onset and saved in EEGLAB-compatible format. Intermediate datasets (Including filtered, ICA-cleaned, interpolated, and epoched versions) were saved in a structured directory to support reproducibility. In a final quality control step, remaining epochs containing artifacts were manually rejected. In certain cases, individual noisy channels within otherwise clean epochs were interpolated to preserve usable data and minimize unnecessary data loss.

After final artifact rejection, the cleaned epoched datasets were exported to CSV format for statistical analysis. Subsequent processing and analysis steps, including trial-level data structuring and statistical modelling, were conducted in R (version 4.5.0; R Core Team, 2025 R). Baseline correction was not applied within EEGLAB to allow flexible implementation in R. For this purpose, baseline correction will be applied in R by subtracting the mean amplitude within a standard –200 to 0 ms pre-stimulus window from each epoch.
The analysis of ERP amplitudes focused on raw microvolt values. This approach was chosen for two primary reasons, based on the experimental design and the sample characteristics. First, the study had a within-subjects design where each child served as their own control. The key comparisons involved relative differences in neural activity between trial types (remembered vs. forgotten) within each participant. This design controls for stable, time- invariant individual differences in EEG signals, such as skull thickness, scalp-to-cortex distance, and general neuroanatomical factors (Huffmeijer et al., 2014; Luck, 2014; Luck, 2014). Second, the participant sample consisted exclusively of 4-year-old children. Given the age homogeneity and the limited sample size, the use of raw amplitudes was deemed appropriate to preserve the maximal information about individual patterns of cognitive processing (Clayson et al., 2021). To ensure data quality, trials with amplitudes exceeding ±3 standard deviations from the participant's mean in the channels of interest were excluded as outliers. This procedure minimized the influence of extreme values and maintains the individual response patterns.

The grand-average ERPs were computed by averaging amplitudes across all valid epochs and within the predefined electrode groups. Figure 3 illustrates the overall ERP morphology for remembered versus forgotten conditions, averaged across all three presentations and all channels of interest. Subsequent figures provide regional specificity: Figure 4 focuses on frontal electrodes (Fz, F3, F7, F4, F8), Figure 5 on central electrodes (Cz, C3, C4), and Figure 6 on parietal electrodes (Pz, P3, P4).

